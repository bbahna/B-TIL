## **âœï¸ ì˜¤ëŠ˜ì˜ í•œ ì¼**

- ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì´ˆê¸° ì„¤ì • & í”¼ë“œë°± ë°˜ì˜ & merge

## **ğŸŒˆ ì˜¤ëŠ˜ì˜ ì„±ì¥**

- TypeORM 3.x ë ˆí¬ì§€í† ë¦¬ íŒ¨í„´ ë°˜ì˜
- Swagger ì„¤ì •
- type ì„¤ì •

<br>

## **â› ì˜¤ëŠ˜ì˜ ì‚½ì§ˆ**

1. ë ˆí¬ì§€í† ë¦¬ íŒ¨í„´ êµ¬ì„±
   custom repositoryë¥¼ ìƒì„±í•˜ë ¤ê³  [ë¬¸ì„œ](https://typeorm.io/custom-repository)ë¥¼ ì°¾ì•„ë´¤ëŠ”ë°, ê¸°ëŒ€ì—ëŠ” ëª» ë¯¸ì³¤ë‹¤. too simple. ì´ê²ƒì €ê²ƒ ì‹œë„í•´ë³¸ ì¤‘ ì´ ë°©ë²•ì´ ì´ë²ˆ 3.x ì—…ê·¸ë ˆì´ë“œì˜ ì˜ë„ì— ë§ì§€ ì•Šì„ê¹Œ ìƒê°í•˜ëŠ”ë°, ë¬¸ì„œì— ëª…í™•íˆ ëª…ì‹œë˜ì–´ìˆëŠ” ê²ƒì„ ëª»ì°¾ì•„ì„œ ì°œì°œí•˜ë‹¤. ì‘ì—… ì§„í–‰í•˜ë©´ì„œ ë³´ê°• ì˜ˆì •..

   ```ts
   // user.repository.ts

   @Injectable()
   export class UserRepository extends Repository<User> {
     constructor(
       @InjectRepository(User)
       private readonly userRepository: Repository<User>
     ) {
       super(userRepository.target, userRepository.manager, userRepository.queryRunner);
     }

     createUser(userId: string, password: string): Promise<User> {
       return this.userRepository.save({ userId, password });
     }

     getUsers(): Promise<User[]> {
       return this.userRepository.find({
         select: {
           id: true,
           userId: true,
           password: false,
         },
       });
     }
   }
   ```

2. Swagger ì»¤ìŠ¤í…€ ë°ì½”ë ˆì´í„°: Response í…œí”Œë¦¿ ì„¤ì •

   ì‘ë‹µ ìŠ¤í‚¤ë§ˆë¥¼ {data, meta}ë¡œ í•˜ê¸°ë¡œ í–ˆë‹¤. Swaggerë¡œ ë§¤ë²ˆ ì„¤ì •í•˜ì§€ ì•Šê³  êµ¬ì„±í•˜ê³  ì‹¶ì–´ì„œ ì»¤ìŠ¤í…€ ë°ì½”ë ˆì´í„°ë¥¼ ë§Œë“¤ì—ˆë‹¤.

   ```ts
   // api-response.decorator.ts

   export class ResponseDto<TData, TMeta> {
     data!: TData;
     meta?: TMeta;
   }

   export const ApiCustomResponse = <T extends Type<any>, M extends Type<any>>(data: T, meta?: M) => {
     if (!meta) {
       return applyDecorators(
         ApiExtraModels(ResponseDto, data),
         ApiOkResponse({
           schema: {
             properties: {
               data: {
                 description: "ì‘ë‹µ ê°’",
                 oneOf: [{ $ref: getSchemaPath(data) }],
               },
             },
           },
         })
       );
     }
     return applyDecorators(
       ApiExtraModels(ResponseDto, data, meta),
       ApiOkResponse({
         schema: {
           properties: {
             data: {
               description: "ì‘ë‹µ ê°’",
               oneOf: [{ $ref: getSchemaPath(data) }],
             },
             meta: {
               description: "ì‘ë‹µ ë©”íƒ€ë°ì´í„°",
               oneOf: [{ $ref: getSchemaPath(meta) }],
             },
           },
         },
       })
     );
   };
   ```

<br>

## **â˜•ï¸ íšŒê³ **

- ì²« PR ë¶€í„° ë™ë£Œë¶„ì´ í”¼ë“œë°±ì„ ì •ì„±ê» ë‚¨ê²¨ì£¼ì…”ì„œ ì•„ì£¼ ë§Œì¡±ìŠ¤ëŸ¬ì› ë‹¤! [PR #1](https://github.com/beside-project/nest-boilerplate/pull/1)ì€ privateì§€ë§Œ, ì €ì˜ íšŒê³ ìš©ìœ¼ë¡œ ë§í¬ ë‚¨ê²¨ë‘ê² ìŠµë‹ˆë‹¤ã…ã…
